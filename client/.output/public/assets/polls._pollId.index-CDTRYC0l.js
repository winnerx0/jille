import{R as g,a as f,b,r as j,t as i,j as e}from"./main-C2IzVu6Q.js";import{u as v,U as y}from"./users-C1g7feR7.js";import{u as N,v as w,S as k,p as S}from"./api-BflD3T2e.js";import{c as C,B as c,a as P}from"./button-BgKzOnNV.js";import{A as I}from"./arrow-left-YhBHTVDr.js";import{S as A,A as E}from"./share-2-DuDBbTX3.js";import{V as O}from"./vote-B8ZLPzx6.js";const L=[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["path",{d:"m9 12 2 2 4-4",key:"dzmm74"}]],V=C("circle-check",L);function F(){const{pollId:o}=g.useParams(),n=f(),d=b(),[r,x]=j.useState(null),{data:s,isLoading:u,error:h}=v({queryKey:["poll",o],queryFn:()=>S.getPoll(o)}),m=N({mutationFn:t=>w.vote({poll_id:o,option_id:t}),onSuccess:(t,a)=>{i.success("Vote cast successfully!"),x(a),d.invalidateQueries({queryKey:["poll",o]}),d.invalidateQueries({queryKey:["polls"]})},onError:t=>{i.error(t.response?.data?.message||"Failed to cast vote")}});(()=>{const t=localStorage.getItem("access_token");if(!t)return null;try{return JSON.parse(atob(t.split(".")[1])).sub}catch{return null}})();const p=()=>{navigator.clipboard.writeText(window.location.href),i.success("Link copied to clipboard!")};if(u)return e.jsx("div",{className:"min-h-screen flex items-center justify-center bg-background",children:e.jsxs("div",{className:"text-center",children:[e.jsx(k,{className:"w-12 h-12 mb-4 mx-auto text-primary"}),e.jsx("p",{className:"text-muted-foreground animate-pulse",children:"Entering the voting booth..."})]})});if(h||!s)return e.jsx("div",{className:"min-h-screen flex flex-col items-center justify-center bg-background p-4",children:e.jsxs("div",{className:"bg-card p-10 text-center max-w-md w-full relative overflow-hidden",children:[e.jsx("h1",{className:"text-3xl font-black mb-3 tracking-tight",children:"Poll Not Found"}),e.jsx("p",{className:"text-muted-foreground mb-10 leading-relaxed",children:"Oops! The poll you're looking for might have expired, been deleted, or never existed."}),e.jsx(c,{size:"lg",className:"w-full rounded-2xl h-14 text-lg font-bold shadow-lg shadow-primary/20",onClick:()=>n({to:"/home"}),children:"Back to Safety"})]})});const l=new Date(s.expires_at).getTime()>Date.now();return e.jsx("div",{className:"min-h-screen bg-background text-foreground py-16 px-4",children:e.jsxs("div",{className:"max-w-2xl mx-auto",children:[e.jsxs("div",{className:"flex items-center justify-between mb-16",children:[e.jsxs("button",{onClick:()=>n({to:"/home"}),className:"flex items-center gap-2 text-muted-foreground hover:text-foreground transition-all group font-bold",children:[e.jsx(I,{className:"w-5 h-5 group-hover:-translate-x-1 transition-transform"}),"Back"]}),e.jsx("div",{className:"flex gap-4",children:e.jsxs(c,{variant:"ghost",size:"sm",onClick:p,className:"rounded-xl text-muted-foreground",children:[e.jsx(A,{className:"w-4 h-4 mr-2"}),"Share"]})})]}),e.jsxs("div",{className:"text-center mb-16",children:[e.jsx("div",{className:"w-20 h-20 bg-primary/10 text-primary rounded-3xl flex items-center justify-center mx-auto mb-8 animate-in zoom-in duration-500",children:e.jsx(O,{className:"w-10 h-10"})}),e.jsx("h1",{className:"text-4xl md:text-5xl font-black mb-4 tracking-tight leading-tight",children:s.title}),e.jsx("p",{className:"text-muted-foreground font-medium text-lg max-w-md mx-auto",children:r?"Thank you! Your choice has been securely recorded.":"Every vote counts. Make your choice below to participate in this poll."})]}),!s.voted&&e.jsx("div",{className:"grid gap-4 mb-16",children:s.options.map(t=>{const a=r===t.id;return e.jsxs("button",{disabled:m.isPending||!!r||!l,onClick:()=>m.mutate(t.id),className:P("w-full text-left group relative p-6 md:p-8 rounded-3xl border-2 transition-all duration-300 flex items-center justify-between",a?"bg-primary border-primary text-primary-foreground shadow-xl shadow-primary/20 scale-[1.02]":r||!l?"bg-muted/5 border-border/30 opacity-50 cursor-not-allowed":"bg-card border-border hover:border-primary hover:shadow-lg"),children:[e.jsx("span",{className:"text-xl font-bold",children:t.name}),a?e.jsx(V,{className:"w-6 h-6 text-primary-foreground animate-in zoom-in"}):!r&&l&&e.jsx("div",{className:"w-6 h-6 rounded-full border-2 border-border group-hover:border-primary transition-colors"})]},t.id)})}),(r||s.voted)&&e.jsxs("div",{className:"p-8 rounded-4xl bg-green-500/5 border border-green-500/10 text-center animate-in slide-in-from-bottom-8 duration-1000",children:[e.jsx("h3",{className:"text-xl font-bold text-green-600 mb-2",children:"Vote Recorded"}),e.jsx("p",{className:"text-muted-foreground text-sm",children:"You can close this page now or head back to the dashboard."}),e.jsx(c,{variant:"outline",className:"mt-6 rounded-xl",onClick:()=>n({to:"/home"}),children:"Go to Dashboard"})]}),e.jsxs("div",{className:"flex flex-col items-center justify-center gap-6 pt-12 border-t border-border/50 text-muted-foreground grayscale opacity-50",children:[e.jsxs("div",{className:"flex items-center gap-8",children:[e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(y,{className:"w-4 h-4"}),e.jsx("span",{className:"text-xs font-bold uppercase tracking-widest",children:"Anonymous"})]}),e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(E,{className:"w-4 h-4"}),e.jsx("span",{className:"text-xs font-bold uppercase tracking-widest",children:"Verified"})]})]}),e.jsx("p",{className:"text-[10px] font-medium tracking-tighter",children:"JILLE SECURE VOTING PROTOCOL â€¢ 2026"})]})]})})}export{F as component};
