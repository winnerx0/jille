import{a as w,j as a,L as h,t as F}from"./main-C2IzVu6Q.js";import{o as u,s as m,u as N,F as S,a as o,b as c,I as i,c as l}from"./field-zmsoZvfa.js";import{u as I,S as b,a as g}from"./api-BflD3T2e.js";import{B as C}from"./button-BgKzOnNV.js";const k=({type:t})=>{const x=w(),j=u({email:m().email({message:"Invalid email"}),password:m().min(8,{message:"Password must have at least 8 characters"}).max(16,{message:"Password must have at most 16 characters"}),username:m().min(1,{message:"Username required"})}),p=u({email:m().email({message:"Invalid email"}),password:m().min(8,{message:"Password must have at least 8 characters"}).max(16,{message:"Password must have at most 16 characters"})}),{mutate:v,isPending:d}=I({mutationFn:async e=>t==="Register"?g.register(e):g.login(e),onSuccess(e){localStorage.setItem("access_token",e.data.accessToken),localStorage.setItem("refresh_token",e.data.refreshToken),x({to:"/home"})},onError(e){console.log(e);const s=e.response?.data;return F(s.message||"An error occurred")}}),n=N({defaultValues:t==="Register"?{email:"",username:"",password:""}:{email:"",password:""},validators:{onSubmit:t==="Register"?j:p},onSubmit:e=>v(e.value)});return a.jsxs("form",{className:"flex flex-col space-y-4 w-full max-w-125",onSubmit:e=>{e.preventDefault(),n.handleSubmit(e)},children:[a.jsx("h3",{className:"font-semibold text-xl",children:t==="Register"?"Register for Jille":"Welcome back"}),a.jsxs(S,{children:[t==="Register"?a.jsxs(a.Fragment,{children:[a.jsx(n.Field,{name:"email",children:e=>{const s=e.state.meta.isTouched&&!e.state.meta.isValid;return a.jsxs(o,{className:"space-y-1",children:[a.jsx(c,{children:e.name}),a.jsx(i,{id:e.name,name:e.name,onChange:r=>e.handleChange(r.target.value),type:"email",placeholder:"Enter a valid email address"}),s&&a.jsx(l,{errors:e.state.meta.errors})]})}}),a.jsx(n.Field,{name:"username",children:e=>{const s=e.state.meta.isTouched&&!e.state.meta.isValid;return a.jsxs(o,{className:"space-y-1",children:[a.jsx(c,{children:e.name}),a.jsx(i,{id:e.name,name:e.name,onChange:r=>e.handleChange(r.target.value),type:"text",placeholder:"Enter a valid username"}),s&&a.jsx(l,{errors:e.state.meta.errors})]})}}),a.jsx(n.Field,{name:"password",children:e=>{const s=e.state.meta.isTouched&&!e.state.meta.isValid;return a.jsxs(o,{className:"space-y-1",children:[a.jsx(c,{children:e.name}),a.jsx(i,{id:e.name,name:e.name,onChange:r=>e.handleChange(r.target.value),type:"password",placeholder:"Enter a valid password"}),s&&a.jsx(l,{errors:e.state.meta.errors})]})}})]}):a.jsxs(a.Fragment,{children:[a.jsx(n.Field,{name:"email",children:e=>{const s=e.state.meta.isTouched&&!e.state.meta.isValid;return a.jsxs(o,{className:"space-y-1",children:[a.jsx(c,{children:e.name}),a.jsx(i,{id:e.name,name:e.name,onChange:r=>e.handleChange(r.target.value),type:"email",placeholder:"Enter a valid email address"}),s&&a.jsx(l,{errors:e.state.meta.errors})]})}}),a.jsx(n.Field,{name:"password",children:e=>{const s=e.state.meta.isTouched&&!e.state.meta.isValid;return a.jsxs(o,{className:"space-y-1",children:[a.jsx(c,{children:e.name}),a.jsx(i,{id:e.name,name:e.name,onChange:r=>e.handleChange(r.target.value),type:"password",placeholder:"Enter a valid password"}),s&&a.jsx(l,{errors:e.state.meta.errors})]})}})]}),a.jsxs(C,{type:"submit",className:"self-center w-36",disabled:d,children:[d&&a.jsx(b,{})," ",t]})]}),t==="Login"?a.jsxs("p",{className:"self-center",children:["Don't have an account ?"," ",a.jsx(h,{className:"text-foreground/60",to:"/register",children:"Sign up"})]}):a.jsxs("p",{className:"self-center",children:["Have an account ?"," ",a.jsx(h,{className:"text-foreground/60",to:"/login",children:"Sign in"})]})]})};export{k as A};
